<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: backend/test-service-catalog.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: backend/test-service-catalog.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>#!/usr/bin/env node

/**
 * Quick Backend Test Script for Service Catalog System
 * Tests database setup and seed data
 */

async function testDatabaseTables() {
  console.log('\nüìä Testing Database Tables...')
  
  try {
    const { getDatabase } = await import('./src/database/init.js')
    const db = getDatabase()
    
    const tables = [
      'entity_codes',
      'service_catalog_global',
      'service_catalog_entities',
      'service_catalog_custom_services',
      'service_catalog_history',
      'service_catalog_imports'
    ]
    
    for (const table of tables) {
      try {
        const result = db.prepare(`SELECT COUNT(*) as count FROM ${table}`).get()
        console.log(`   ‚úÖ ${table}: ${result.count} records`)
      } catch (error) {
        console.log(`   ‚ùå ${table}: ${error.message}`)
      }
    }
    
    // Check if entities are seeded
    const entities = db.prepare('SELECT * FROM entity_codes').all()
    console.log(`\n   üìã Seeded Entities: ${entities.length}`)
    entities.forEach(e => {
      console.log(`      - ${e.entity_name} (${e.entity_code})`)
    })
    
    // Check if services are seeded
    const services = db.prepare('SELECT COUNT(*) as count FROM service_catalog_global').get()
    console.log(`\n   üìã Global Services: ${services.count}`)
    
  } catch (error) {
    console.log(`   ‚ùå Database test error: ${error.message}`)
  }
}

async function testSeedScripts() {
  console.log('\nüå± Testing Seed Scripts...')
  
  try {
    // Test entity codes seed
    const { seedEntityCodes } = await import('./src/scripts/seedEntityCodes.js')
    seedEntityCodes()
    console.log('   ‚úÖ Entity codes seeded')
    
    // Test global service catalog seed
    const { seedGlobalServiceCatalog } = await import('./src/scripts/seedGlobalServiceCatalog.js')
    const result = seedGlobalServiceCatalog()
    console.log(`   ‚úÖ Global service catalog seeded: ${result.inserted} services`)
    
  } catch (error) {
    console.log(`   ‚ùå Seed script error: ${error.message}`)
    console.log(`   Stack: ${error.stack}`)
  }
}

async function testControllers() {
  console.log('\nüéÆ Testing Controller Functions...')
  
  try {
    const { getEntityCodes } = await import('./src/controllers/entityCodesController.js')
    const { getGlobalCatalog } = await import('./src/controllers/serviceCatalogController.js')
    
    // Create mock request/response objects
    const mockReq = {}
    const mockRes = {
      json: (data) => {
        console.log(`   ‚úÖ getEntityCodes returned ${data.length} entities`)
        return data
      },
      status: (code) => ({
        json: (data) => {
          console.log(`   ‚ùå Error ${code}:`, data)
          return data
        }
      })
    }
    
    // Test entity codes (this will fail without auth, but we can check if function exists)
    console.log('   ‚úÖ Controller functions are importable')
    
  } catch (error) {
    console.log(`   ‚ùå Controller test error: ${error.message}`)
  }
}

async function runTests() {
  console.log('üß™ Backend Service Catalog System Test')
  console.log('=====================================\n')
  
  // Test 1: Database tables
  await testDatabaseTables()
  
  // Test 2: Seed scripts
  await testSeedScripts()
  
  // Test 3: Re-check database after seeding
  console.log('\nüìä Database After Seeding...')
  await testDatabaseTables()
  
  // Test 4: Controllers
  await testControllers()
  
  console.log('\n\nüìù API Endpoint Testing:')
  console.log('   To test API endpoints manually:')
  console.log('   1. Start server: npm run dev')
  console.log('   2. Login: POST /api/auth/login')
  console.log('   3. Test endpoints with token:')
  console.log('      - GET /api/entity-codes')
  console.log('      - GET /api/service-catalog/global')
  console.log('      - GET /api/service-catalog/entity/BDO_AL_NISF')
  console.log('      - GET /api/integration/service-types?entity=BDO_AL_NISF')
  
  console.log('\n‚úÖ Backend test completed!')
}

runTests().catch(console.error)
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#BASE_URL">BASE_URL</a></li><li><a href="global.html#testDatabaseTables">testDatabaseTables</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.5</a> on Sat Feb 07 2026 12:14:58 GMT+0300 (Arabian Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
